<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="619px" preserveAspectRatio="none" style="width:1385px;height:619px;background:#FFFFFF;" version="1.1" viewBox="0 0 1385 619" width="1385px" zoomAndPan="magnify"><title>TinyLlama Desktop - Refactored Local Architecture (MVC + Services)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="542.917" x="414.1039" y="22.9951">TinyLlama Desktop - Refactored Local Architecture (MVC + Services)</text><!--cluster tinyllama--><g class="cluster" data-entity="tinyllama" data-source-line="7" data-uid="ent0005" id="cluster_tinyllama"><path d="M492.12,191.2969 L566.7841,191.2969 A3.75,3.75 0 0 1 569.2841,193.7969 L576.2841,213.5938 L859.12,213.5938 A2.5,2.5 0 0 1 861.62,216.0938 L861.62,609.7969 A2.5,2.5 0 0 1 859.12,612.2969 L492.12,612.2969 A2.5,2.5 0 0 1 489.62,609.7969 L489.62,193.7969 A2.5,2.5 0 0 1 492.12,191.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="489.62" x2="576.2841" y1="213.5938" y2="213.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="73.6641" x="493.62" y="206.292">tinyllama</text></g><!--cluster gui--><g class="cluster" data-entity="gui" data-source-line="6" data-uid="ent0003" id="cluster_gui"><path d="M516.12,234.2969 L541.9071,234.2969 A3.75,3.75 0 0 1 544.4071,236.7969 L551.4071,256.5938 L835.12,256.5938 A2.5,2.5 0 0 1 837.62,259.0938 L837.62,585.7969 A2.5,2.5 0 0 1 835.12,588.2969 L516.12,588.2969 A2.5,2.5 0 0 1 513.62,585.7969 L513.62,236.7969 A2.5,2.5 0 0 1 516.12,234.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="513.62" x2="551.4071" y1="256.5938" y2="256.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="24.7871" x="517.62" y="249.292">gui</text></g><!--cluster Controllers--><g class="cluster" data-entity="Controllers" data-source-line="24" data-uid="ent0008" id="cluster_Controllers"><path d="M429.12,43.2969 L517.5243,43.2969 A3.75,3.75 0 0 1 520.0243,45.7969 L527.0243,65.5938 L1111.12,65.5938 A2.5,2.5 0 0 1 1113.62,68.0938 L1113.62,139.7969 A2.5,2.5 0 0 1 1111.12,142.2969 L429.12,142.2969 A2.5,2.5 0 0 1 426.62,139.7969 L426.62,45.7969 A2.5,2.5 0 0 1 429.12,43.2969" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="426.62" x2="527.0243" y1="65.5938" y2="65.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="87.4043" x="430.62" y="58.292">Controllers</text></g><!--class TinyLlamaView--><g class="entity" data-entity="TinyLlamaView" data-source-line="7" data-uid="ent0004" id="entity_TinyLlamaView"><rect fill="#F1F1F1" height="113.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="203.9121" x="617.62" y="459.2969"/><ellipse cx="662.5184" cy="475.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M665.4872,480.9375 Q664.9091,481.2344 664.2684,481.375 Q663.6278,481.5313 662.9247,481.5313 Q660.4247,481.5313 659.0966,479.8906 Q657.7841,478.2344 657.7841,475.1094 Q657.7841,471.9844 659.0966,470.3281 Q660.4247,468.6719 662.9247,468.6719 Q663.6278,468.6719 664.2684,468.8281 Q664.9247,468.9844 665.4872,469.2813 L665.4872,472 Q664.8622,471.4219 664.2684,471.1563 Q663.6747,470.875 663.0497,470.875 Q661.7059,470.875 661.0184,471.9531 Q660.3309,473.0156 660.3309,475.1094 Q660.3309,477.2031 661.0184,478.2813 Q661.7059,479.3438 663.0497,479.3438 Q663.6747,479.3438 664.2684,479.0781 Q664.8622,478.7969 665.4872,478.2188 L665.4872,480.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.6152" x="683.0184" y="480.1436">TinyLlamaView</text><line style="stroke:#181818;stroke-width:0.5;" x1="618.62" x2="820.5321" y1="491.2969" y2="491.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="618.62" x2="820.5321" y1="499.2969" y2="499.2969"/><ellipse cx="628.62" cy="512.9453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177.9121" x="637.62" y="516.292">update_cost(value, color)</text><ellipse cx="628.62" cy="529.2422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.7031" x="637.62" y="532.5889">append_output(text)</text><ellipse cx="628.62" cy="545.5391" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.9434" x="637.62" y="548.8857">set_busy(flag)</text><ellipse cx="628.62" cy="561.8359" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.9307" x="637.62" y="565.1826">bind_buttons()</text></g><!--class AppState--><g class="entity" data-entity="AppState" data-source-line="14" data-uid="ent0006" id="entity_AppState"><rect fill="#F1F1F1" height="113.1875" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.9492" x="706.12" y="269.2969"/><ellipse cx="729.4635" cy="285.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M732.4322,290.9375 Q731.8541,291.2344 731.2135,291.375 Q730.5728,291.5313 729.8697,291.5313 Q727.3697,291.5313 726.0416,289.8906 Q724.7291,288.2344 724.7291,285.1094 Q724.7291,281.9844 726.0416,280.3281 Q727.3697,278.6719 729.8697,278.6719 Q730.5728,278.6719 731.2135,278.8281 Q731.8697,278.9844 732.4322,279.2813 L732.4322,282 Q731.8072,281.4219 731.2135,281.1563 Q730.6197,280.875 729.9947,280.875 Q728.651,280.875 727.9635,281.9531 Q727.276,283.0156 727.276,285.1094 Q727.276,287.2031 727.9635,288.2813 Q728.651,289.3438 729.9947,289.3438 Q730.6197,289.3438 731.2135,289.0781 Q731.8072,288.7969 732.4322,288.2188 L732.4322,290.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64.4082" x="745.3176" y="290.1436">AppState</text><line style="stroke:#181818;stroke-width:0.5;" x1="707.12" x2="820.0692" y1="301.2969" y2="301.2969"/><ellipse cx="717.12" cy="314.9453" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.9492" x="726.12" y="318.292">idle_minutes</text><ellipse cx="717.12" cy="331.2422" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.4629" x="726.12" y="334.5889">auth_token</text><ellipse cx="717.12" cy="347.5391" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.1035" x="726.12" y="350.8857">current_cost</text><ellipse cx="717.12" cy="363.8359" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.1523" x="726.12" y="367.1826">history</text><line style="stroke:#181818;stroke-width:0.5;" x1="707.12" x2="820.0692" y1="374.4844" y2="374.4844"/></g><!--entity ThreadService--><g class="entity" data-entity="ThreadService" data-source-line="21" data-uid="ent0007" id="entity_ThreadService"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141.001" x="530.12" y="302.7969"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="651.121" y="307.7969"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="649.121" y="309.7969"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="649.121" y="313.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.001" x="545.12" y="335.792">ThreadService</text></g><!--class PromptController--><g class="entity" data-entity="PromptController" data-source-line="25" data-uid="ent0009" id="entity_PromptController"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="151.9502" x="609.62" y="78.2969"/><ellipse cx="624.62" cy="94.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M627.5888,99.9375 Q627.0106,100.2344 626.37,100.375 Q625.7294,100.5313 625.0263,100.5313 Q622.5263,100.5313 621.1981,98.8906 Q619.8856,97.2344 619.8856,94.1094 Q619.8856,90.9844 621.1981,89.3281 Q622.5263,87.6719 625.0263,87.6719 Q625.7294,87.6719 626.37,87.8281 Q627.0263,87.9844 627.5888,88.2813 L627.5888,91 Q626.9638,90.4219 626.37,90.1563 Q625.7763,89.875 625.1513,89.875 Q623.8075,89.875 623.12,90.9531 Q622.4325,92.0156 622.4325,94.1094 Q622.4325,96.2031 623.12,97.2813 Q623.8075,98.3438 625.1513,98.3438 Q625.7763,98.3438 626.37,98.0781 Q626.9638,97.7969 627.5888,97.2188 L627.5888,99.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119.9502" x="638.62" y="99.1436">PromptController</text><line style="stroke:#181818;stroke-width:0.5;" x1="610.62" x2="760.5702" y1="110.2969" y2="110.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="610.62" x2="760.5702" y1="118.2969" y2="118.2969"/></g><!--class GPUController--><g class="entity" data-entity="GPUController" data-source-line="26" data-uid="ent0010" id="entity_GPUController"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.7109" x="797.12" y="78.2969"/><ellipse cx="812.12" cy="94.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M815.0888,99.9375 Q814.5106,100.2344 813.87,100.375 Q813.2294,100.5313 812.5263,100.5313 Q810.0263,100.5313 808.6981,98.8906 Q807.3856,97.2344 807.3856,94.1094 Q807.3856,90.9844 808.6981,89.3281 Q810.0263,87.6719 812.5263,87.6719 Q813.2294,87.6719 813.87,87.8281 Q814.5263,87.9844 815.0888,88.2813 L815.0888,91 Q814.4638,90.4219 813.87,90.1563 Q813.2763,89.875 812.6513,89.875 Q811.3075,89.875 810.62,90.9531 Q809.9325,92.0156 809.9325,94.1094 Q809.9325,96.2031 810.62,97.2813 Q811.3075,98.3438 812.6513,98.3438 Q813.2763,98.3438 813.87,98.0781 Q814.4638,97.7969 815.0888,97.2188 L815.0888,99.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.7109" x="826.12" y="99.1436">GPUController</text><line style="stroke:#181818;stroke-width:0.5;" x1="798.12" x2="926.8309" y1="110.2969" y2="110.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="798.12" x2="926.8309" y1="118.2969" y2="118.2969"/></g><!--class CostController--><g class="entity" data-entity="CostController" data-source-line="27" data-uid="ent0011" id="entity_CostController"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="132.2969" x="442.62" y="78.2969"/><ellipse cx="457.62" cy="94.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M460.5888,99.9375 Q460.0106,100.2344 459.37,100.375 Q458.7294,100.5313 458.0263,100.5313 Q455.5263,100.5313 454.1981,98.8906 Q452.8856,97.2344 452.8856,94.1094 Q452.8856,90.9844 454.1981,89.3281 Q455.5263,87.6719 458.0263,87.6719 Q458.7294,87.6719 459.37,87.8281 Q460.0263,87.9844 460.5888,88.2813 L460.5888,91 Q459.9638,90.4219 459.37,90.1563 Q458.7763,89.875 458.1513,89.875 Q456.8075,89.875 456.12,90.9531 Q455.4325,92.0156 455.4325,94.1094 Q455.4325,96.2031 456.12,97.2813 Q456.8075,98.3438 458.1513,98.3438 Q458.7763,98.3438 459.37,98.0781 Q459.9638,97.7969 460.5888,97.2188 L460.5888,99.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.2969" x="471.62" y="99.1436">CostController</text><line style="stroke:#181818;stroke-width:0.5;" x1="443.62" x2="573.9169" y1="110.2969" y2="110.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="443.62" x2="573.9169" y1="118.2969" y2="118.2969"/></g><!--class AuthController--><g class="entity" data-entity="AuthController" data-source-line="28" data-uid="ent0012" id="entity_AuthController"><rect fill="#F1F1F1" height="48" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133.9854" x="963.62" y="78.2969"/><ellipse cx="978.62" cy="94.2969" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M981.5888,99.9375 Q981.0106,100.2344 980.37,100.375 Q979.7294,100.5313 979.0263,100.5313 Q976.5263,100.5313 975.1981,98.8906 Q973.8856,97.2344 973.8856,94.1094 Q973.8856,90.9844 975.1981,89.3281 Q976.5263,87.6719 979.0263,87.6719 Q979.7294,87.6719 980.37,87.8281 Q981.0263,87.9844 981.5888,88.2813 L981.5888,91 Q980.9638,90.4219 980.37,90.1563 Q979.7763,89.875 979.1513,89.875 Q977.8075,89.875 977.12,90.9531 Q976.4325,92.0156 976.4325,94.1094 Q976.4325,96.2031 977.12,97.2813 Q977.8075,98.3438 979.1513,98.3438 Q979.7763,98.3438 980.37,98.0781 Q980.9638,97.7969 981.5888,97.2188 L981.5888,99.9375 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.9854" x="992.62" y="99.1436">AuthController</text><line style="stroke:#181818;stroke-width:0.5;" x1="964.62" x2="1096.6054" y1="110.2969" y2="110.2969"/><line style="stroke:#181818;stroke-width:0.5;" x1="964.62" x2="1096.6054" y1="118.2969" y2="118.2969"/></g><!--entity User--><g class="entity" data-entity="User" data-source-line="4" data-uid="ent0002" id="entity_User"><ellipse cx="379.5751" cy="296.2969" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M379.5751,304.2969 L379.5751,331.2969 M366.5751,312.2969 L392.5751,312.2969 M379.5751,331.2969 L366.5751,346.2969 M379.5751,331.2969 L392.5751,346.2969" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="363.62" y="360.792">User</text></g><!--link User to TinyLlamaView--><g class="link" data-entity-1="User" data-entity-2="TinyLlamaView" data-source-line="31" data-uid="lnk13" id="link_User_TinyLlamaView"><path codeLine="31" d="M395.83,339.5369 C422.37,360.0469 477.22,400.9569 527.62,429.2969 C555.92,445.2169 582.2625,457.9704 611.7525,471.0104" fill="none" id="User-to-TinyLlamaView" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="617.24,473.4369,610.6264,466.1389,612.6671,471.4148,607.3912,473.4555,617.24,473.4369" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.7568" x="528.62" y="425.3638">clicks buttons / types prompt</text></g><!--link TinyLlamaView to PromptController--><g class="link" data-entity-1="TinyLlamaView" data-entity-2="PromptController" data-source-line="33" data-uid="lnk14" id="link_TinyLlamaView_PromptController"><path codeLine="33" d="M821.9,502.1469 C867.56,490.8569 917.34,469.5469 945.62,429.2969 C1030.28,308.7969 955.33,164.2869 949.62,158.2969 C936.57,144.6169 797.92,155.0769 779.62,150.2969 C760.02,145.1769 745.0118,138.5501 728.3318,129.4101" fill="none" id="TinyLlamaView-to-PromptController" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="723.07,126.5269,729.0405,134.3597,727.4548,128.9296,732.8849,127.3439,723.07,126.5269" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.6616" x="986.62" y="330.3638">on_send(prompt)</text></g><!--link TinyLlamaView to GPUController--><g class="link" data-entity-1="TinyLlamaView" data-entity-2="GPUController" data-source-line="34" data-uid="lnk15" id="link_TinyLlamaView_GPUController"><path codeLine="34" d="M821.95,511.4069 C913.61,502.2469 1043.08,472.8369 1106.62,382.2969 C1214.71,228.2769 1170.06,206.5869 1092.62,158.2969 C1065.05,141.1069 977.82,159.3569 946.62,150.2969 C928.8,145.1269 915.7622,138.7478 900.9022,129.6178" fill="none" id="TinyLlamaView-to-GPUController" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="895.79,126.4769,901.3643,134.5964,900.0502,129.0943,905.5522,127.7802,895.79,126.4769" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.1553" x="1171.62" y="330.3638">on_stop_gpu()</text></g><!--link ThreadService to CostController--><g class="link" data-entity-1="ThreadService" data-entity-2="CostController" data-source-line="35" data-uid="lnk16" id="link_ThreadService_CostController"><path codeLine="35" d="M580.39,302.7069 C548.48,269.6069 482.83,208.3669 412.62,183.2969 C392.09,175.9669 231.71,191.0169 216.62,175.2969 C183.58,140.8769 340.5507,119.5135 436.4907,109.7635" fill="none" id="ThreadService-to-CostController" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="442.46,109.1569,433.1017,106.0873,437.4856,109.6624,433.9105,114.0463,442.46,109.1569" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.8242" x="217.62" y="171.3638">every 30 s tick</text></g><!--link CostController to ThreadService--><g class="link" data-entity-1="CostController" data-entity-2="ThreadService" data-source-line="39" data-uid="lnk19" id="link_CostController_ThreadService"><path codeLine="39" d="M442.44,104.1069 C305.04,106.9069 6,119.4269 60.62,175.2969 C74.29,189.2869 394.14,176.8869 412.62,183.2969 C483.05,207.7369 544.4648,264.899 576.2948,298.209" fill="none" id="CostController-to-ThreadService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="580.44,302.5469,577.1142,293.2766,576.9857,298.9319,571.3303,298.8035,580.44,302.5469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.8159" x="61.62" y="171.3638">run_async(fetch_cost)</text></g><!--link TinyLlamaView to AuthController--><g class="link" data-entity-1="TinyLlamaView" data-entity-2="AuthController" data-source-line="36" data-uid="lnk17" id="link_TinyLlamaView_AuthController"><path codeLine="36" d="M821.7,505.4369 C966.07,489.8169 1218.44,452.9469 1272.62,382.2969 C1326.44,312.1169 1324.42,254.9869 1272.62,183.2969 C1233.03,128.5169 1160.502,111.2063 1103.612,105.6863" fill="none" id="TinyLlamaView-to-AuthController" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1097.64,105.1069,1106.2116,109.9574,1102.6166,105.5898,1106.9842,101.9948,1097.64,105.1069" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.5049" x="1312.62" y="330.3638">on_login()</text></g><!--link PromptController to ThreadService--><g class="link" data-entity-1="PromptController" data-entity-2="ThreadService" data-source-line="38" data-uid="lnk18" id="link_PromptController_ThreadService"><path codeLine="38" d="M648.66,126.4369 C631.9,135.6869 611.43,145.3069 591.62,150.2969 C577.23,153.9269 334.95,147.6469 324.62,158.2969 C319.36,163.7169 319.52,169.7169 324.62,175.2969 C337.86,189.7969 394.3,176.2369 412.62,183.2969 C481.8,209.9669 543.159,265.6827 575.479,298.3327" fill="none" id="PromptController-to-ThreadService" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="579.7,302.5969,576.2112,293.3866,576.1825,299.0434,570.5257,299.0147,579.7,302.5969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.6113" x="325.62" y="171.3638">run_async(send_prompt)</text></g><!--link PromptController to AppState--><g class="link" data-entity-1="PromptController" data-entity-2="AppState" data-source-line="41" data-uid="lnk20" id="link_PromptController_AppState"><path codeLine="41" d="M688.81,126.2969 C691.11,140.5869 694.68,159.2269 699.62,175.2969 C709.41,207.1369 721.2769,235.9393 733.9169,263.6093" fill="none" id="PromptController-to-AppState" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="736.41,269.0669,736.3088,259.2185,734.3324,264.5189,729.032,262.5426,736.41,269.0669" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.5293" x="700.62" y="171.3638">write history</text></g><!--link CostController to AppState--><g class="link" data-entity-1="CostController" data-entity-2="AppState" data-source-line="42" data-uid="lnk21" id="link_CostController_AppState"><path codeLine="42" d="M517.06,126.3769 C524.48,143.0669 537.03,164.4969 555.62,175.2969 C581.22,190.1669 663.72,167.2769 688.62,183.2969 C718.78,202.7069 735.5284,232.8522 746.7684,263.5722" fill="none" id="CostController-to-AppState" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="748.83,269.2069,749.494,259.3804,747.112,264.5113,741.9811,262.1293,748.83,269.2069" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.8188" x="556.62" y="171.3638">update current_cost</text></g><!--link AuthController to AppState--><g class="link" data-entity-1="AuthController" data-entity-2="AppState" data-source-line="43" data-uid="lnk22" id="link_AuthController_AppState"><path codeLine="43" d="M1016.14,126.4369 C1004.71,142.7069 987.27,163.5769 966.62,175.2969 C950.09,184.6769 941.69,174.9569 924.62,183.2969 C882.16,204.0469 846.4061,234.758 816.9261,264.748" fill="none" id="AuthController-to-AppState" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="812.72,269.0269,821.8817,265.4126,816.2251,265.4612,816.1766,259.8045,812.72,269.0269" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.8589" x="987.62" y="171.3638">set auth_token</text></g><!--link GPUController to AppState--><g class="link" data-entity-1="GPUController" data-entity-2="AppState" data-source-line="44" data-uid="lnk23" id="link_GPUController_AppState"><path codeLine="44" d="M852.21,126.5869 C837.22,160.1269 811.5378,217.5789 790.9878,263.5689" fill="none" id="GPUController-to-AppState" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="788.54,269.0469,795.8636,262.4617,790.5798,264.4819,788.5597,259.198,788.54,269.0469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.4561" x="836.62" y="171.3638">mark gpu_stopped</text></g><!--link AppState to TinyLlamaView--><g class="link" data-entity-1="AppState" data-entity-2="TinyLlamaView" data-source-line="46" data-uid="lnk24" id="link_AppState_TinyLlamaView"><path codeLine="46" d="M739.65,382.6969 C736.18,392.4269 732.98,402.5569 730.62,412.2969 C726.97,427.3469 725.1732,437.9604 723.5432,453.3204" fill="none" id="AppState-to-TinyLlamaView" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="722.91,459.2869,727.8374,450.7592,723.4376,454.3148,719.8821,449.915,722.91,459.2869" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.1489" x="731.62" y="425.3638">via callbacks/events (update UI)</text></g><!--SRC=[VLHDRzim3BthLn0zEUZI3jWjXm511Wm5Eg1OcruDHMOS8R8aI5HIO-X_7_qHDtQz7KtoyJsIJvR6k7EbtxGj1Mao22_Qrez6LX9-O3oIyx24txYNYbp00XwTaWRMGHqqeQ8K4B9VhnkuXMSC9wqmBeHeYs4RCGZXfJhA4k66kB5f6j-LIT_07m6WZ8pnW_5LuxcD0zmcNqZ2NBb8sKcQX5z0EUF2eajBxz4MkKla4sM4RzGd8bA-Ix7EzaQMVModkNINY9oDMHDx5mFvsljdOgOBhouCvfMsYJ3sL8aEERaZskvRfH3GKYkjYnnqv7dheR6hlBDS0Y-7WBBe5oFUhvQnSPQ2CmP3l5x5Ks0iVII7nC-dxKnqmn9cmcjMV1LctkOKi5n-d-nwnG2jZX7wvS0zKEqnWczr234kRnfC5N8FP_F8nyWwq686D5BV8zXPUUaJtsEqfRP-F1S3y8IXXczV8GAnu1cAySmTXt6bjamWFebkLp6YNK58DfUnjYfhfialqqoq_1-vHrA7rXd_OXtyje9pu2S45_FCy5pLTiy1HjwRZ3n1y4E0A-kEJp2fhMGu0X-ZlOh7GeWXEMUQavR0Vm6pOpV7UxwDfGXPBt7xiFWB]--></g></svg>